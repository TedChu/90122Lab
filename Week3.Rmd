---
title: 'Week 3: Visualisation of Spatial Data -- ggplot2'
---

<div style="margin-bottom:50px;">
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

</div>


# ggplot2
According to wikipedia and R-project website, 
*``ggplot2 is a data visualization package for the statistical programming language R. Created by Hadley Wickham in 2005, ggplot2 is an implementation of Leland Wilkinson's Gurky Gangâ€”a general scheme for data visualization which breaks up graphs into semantic components such as scales and layers. ggplot2 can serve as a replacement for the base graphics in R and contains a number of defaults for web and print display of common scales. Since 2005, ggplot2 has grown in use to become one of the most popular R packages."*

It is a general framework for data visualisation, and in this class, we will use it to visualise spatial data and spatio-temporal data. 

* Please study Chapter 3 of the book *R for Data Science* (https://r4ds.had.co.nz/data-visualisation.html). 
  + 3.1 --- 3.6: required
  + 3.7 --- end: optional



# ggplot for spatial data

R package *maps* and *mapdata* provide some maps. 

## USA map
We will use the USA map
```{r, echo=TRUE, fig.width=6, fig.align="center"}
library(ggplot2)
library(sf)
library(maps)
library(mapdata)
library(sp)
usa <- map_data("usa")
dim(usa)
head(usa)
tail(usa)
```

First, we plot usa map
```{r, echo=TRUE, fig.width=10, fig.align="center"}
library(gridExtra)
gg0 = ggplot() + geom_polygon(data = usa, aes(x=long, y = lat, group = group)) + 
  coord_fixed(1.3)
gg1 <- ggplot() + 
  geom_polygon(data = usa, aes(x=long, y = lat, group = group), fill = "violet", color = "blue") + 
  coord_fixed(1.3)
labs <- data.frame(
  long = c(-122.064873, -122.306417),
  lat = c(36.951968, 47.644855),
  names = c("SWFSC-FED", "NWFSC"),
  stringsAsFactors = FALSE
)  
gg2 = gg1 + 
  geom_point(data = labs, aes(x = long, y = lat), color = "yellow", size = 2)

grid.arrange(gg0, gg1, gg2, nrow = 1)
```

* Key points
  + "group = group" is essential, you can try code without the group argument
  + coord_fixed(): It fixes the relationship between one unit in the y direction and one unit in the x direction. 



## US state
```{r, echo=TRUE, fig.width=10, fig.align="center", warning = F}
### Draw plots for all USA States
states <- map_data("state")
ggplot(data = states) + 
  geom_polygon(aes(x = long, y = lat, fill = region, group = group), color = "white") + 
  coord_fixed(1.3) + guides(fill=FALSE) 

### Draw a subset of USA states
### Use function subset to select states. 
west_coast <- subset(states, region %in% c("california", "oregon", "washington"))
ggplot(data = west_coast) + 
  geom_polygon(aes(x = long, y = lat, group = group), fill = "palegreen", color = "black") + 
  coord_fixed(1.3)
```

Can you tell the difference between *color* and *fill* argument? 


